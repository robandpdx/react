name: setup_node_modules
runs:
  using: composite
  steps:
  - name: restore_cache
    uses: actions/cache@v3.3.2
    with:
      key: v2-yarn_cache-{{ arch }}-{{ checksum "yarn.lock" }}
      path: UPDATE_ME
      restore-keys: v2-yarn_cache-{{ arch }}-{{ checksum "yarn.lock" }}
  - name: Install dependencies
    run: |-
      yarn install --frozen-lockfile --cache-folder ~/.cache/yarn
      if [ $? -ne 0 ]; then
        yarn install --frozen-lockfile --cache-folder ~/.cache/yarn
      fi
    env:
      ELECTRON_SKIP_BINARY_DOWNLOAD: 1
    shell: bash
  - name: save_cache
    uses: actions/cache@v3.3.2
    with:
      path: "~/.cache/yarn"
      key: v2-yarn_cache-{{ arch }}-{{ checksum "yarn.lock" }}